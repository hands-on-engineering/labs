
\newcommand\YAMLcolonstyle{\color{red}}
\newcommand\YAMLkeystyle{\color{black}}
\newcommand\YAMLvaluestyle{\color{blue}}

\makeatletter

    % here is a macro expanding to the name of the language
% (handy if you decide to change it further down the road)
    \newcommand\language@yaml{yaml}

    \expandafter\expandafter\expandafter\lstdefinelanguage
    \expandafter{\language@yaml}
{
    keywords={true,false,null,y,n},
        keywordstyle=\color{darkgray},
        basicstyle=\YAMLkeystyle,                                 % assuming a key comes first
            sensitive=false,
        comment=[l]{\#},
        morecomment=[s]{/*}{*/},
        commentstyle=\color{purple}\ttfamily,
        stringstyle=\YAMLvaluestyle\ttfamily,
        moredelim=[l][\color{orange}]{\&},
        moredelim=[l][\color{magenta}]{*},
        moredelim=**[il][\YAMLcolonstyle{:}\YAMLvaluestyle]{:},   % switch to value style at :
            morestring=[b]',
        morestring=[b]",
        literate =    {---}{{\ProcessThreeDashes}}3
        {>}{{\textcolor{red}\textgreater}}1
    {|}{{\textcolor{red}\textbar}}1
    {\ -\ }{{-\ }}3,
}

% switch to key style at EOL
\lst@AddToHook{EveryLine}{\ifx\lst@language\language@yaml\YAMLkeystyle\fi}
\makeatother

\newcommand\ProcessThreeDashes{\llap{\color{cyan}\mdseries-{-}-}}

